<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexusOS 13 RC</title>
    <link id="favicon" rel="icon" href="https://www.google.com/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap" rel="stylesheet">
    <!-- MARKED.JS FOR MARKDOWN PARSING -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <!-- OOBE LAYER (Pill UI) -->
    <div id="oobe-overlay">
        <div class="pill-container">
            <div class="pill-header">NexusOS 13 RC</div>
            <div class="pill-desc">Select a Tab Cloak to begin your session.</div>
            
            <!-- In-Pill Spoof Grid -->
            <div class="spoof-grid" id="oobe-spoof-grid" style="max-height: 200px; margin-bottom: 25px;"></div>
            
            <button class="btn btn-primary" style="width:100%" onclick="OOBE.finish()">Enter System</button>
        </div>
    </div>

    <!-- SPOOF MODAL (Settings) -->
    <div id="spoof-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">Tab Cloak</span>
                <button class="btn btn-danger" style="padding:6px 12px;" onclick="Modals.close('spoof-modal')">Close</button>
            </div>
            <div class="spoof-grid" id="settings-spoof-grid"></div>
        </div>
    </div>

    <!-- ADD APP MODAL -->
    <div id="add-game-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">Add Custom App</span>
                <button class="btn btn-danger" style="padding:6px 12px;" onclick="Modals.close('add-game-modal')">Cancel</button>
            </div>
            <div style="display:flex; flex-direction:column; gap:15px;">
                <input type="text" class="st-input" id="ag-title" placeholder="App Name (e.g., Minecraft)" style="width:100%">
                <input type="text" class="st-input" id="ag-url" placeholder="URL (e.g., https://game.com)" style="width:100%">
                
                <div style="display:flex; gap:10px; margin-top:5px;">
                    <button class="btn btn-ghost" onclick="AddGame.setType('favicon')" id="btn-fav">Use Favicon</button>
                    <button class="btn btn-ghost" onclick="AddGame.setType('image')" id="btn-img">Custom Image</button>
                </div>

                <div id="ag-img-input-container" style="display:none; flex-direction:column; gap:10px;">
                     <input type="text" class="st-input" id="ag-img-url" placeholder="Image URL" style="width:100%">
                     <div style="text-align:center; font-size:0.8rem; color:var(--text-dim)">OR</div>
                     <input type="file" id="ag-file" accept="image/*" style="color:var(--text-dim)">
                </div>
                <button class="btn btn-primary" style="margin-top:10px;" onclick="AddGame.save()">Add to Library</button>
            </div>
        </div>
    </div>

    <!-- CHANGELOG MODAL -->
    <div id="changelog-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">Changelog</span>
                <button class="btn btn-danger" style="padding:6px 12px;" onclick="Modals.close('changelog-modal')">Close</button>
            </div>
            <div class="nc-body" id="changelog-content" style="max-height: 60vh; padding-right: 15px;">
                <div class="notif-loading">Loading Changelog...</div>
            </div>
        </div>
    </div>

    <!-- BACKGROUND -->
    <div id="bg-wrapper"><div id="bg-default"></div></div>
    <div id="bg-orb"></div>

    <!-- MAIN INTERFACE -->
    <div id="main-interface">
        <div class="top-bar">
            <div class="nav-pill">
                <div class="nav-item active" onclick="View.set('games')">Library</div>
                <div class="nav-item" onclick="View.set('settings')">Settings</div>
            </div>
            <div class="system-tray">
                <div class="clock tray-item" id="clock" onclick="Todo.toggle()"></div>
                
                <!-- MUSIC PLAYER ICON -->
                <div class="tray-item icon-btn" onclick="MusicApp.toggle()" style="width:44px; padding:0;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="18" r="4"/><path d="M12 18V2l7 4"/></svg>
                </div>

                <!-- NOTIFICATION ICON -->
                <div class="tray-item icon-btn" onclick="Notifications.toggle()" style="width:44px; padding:0;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>
                </div>

                <div class="tray-item icon-btn" onclick="Utils.toggleFull()" style="width:44px; padding:0;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
                </div>

                <!-- NOTIFICATION CENTER -->
                <div id="notification-center">
                    <div class="nc-header">
                        <span class="nc-title">Notifications</span>
                        <button class="btn btn-ghost" style="padding:4px 10px; font-size:0.75rem;" onclick="Notifications.reload()">Refresh</button>
                    </div>
                    <div class="nc-body" id="notif-content">
                        <div class="notif-loading">Loading Updates...</div>
                    </div>
                </div>

                <!-- TODO WIDGET -->
                <div id="todo-widget">
                    <div class="todo-input-group">
                        <input type="text" class="todo-input" id="todo-input" placeholder="Task..." onkeypress="Todo.handleInput(event)">
                        <input type="time" class="time-input" id="todo-time" title="Set Alarm">
                        <button class="btn btn-primary" style="padding:0 12px;" onclick="Todo.add()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg></button>
                    </div>
                    <ul class="todo-list" id="todo-list"></ul>
                </div>
            </div>
        </div>

        <div class="view-container">
            <!-- LIBRARY -->
            <div id="games-view" class="content-view active-view">
                <div class="hero-area">
                    <div class="hero-title" id="hero-text">Select App</div>
                    <div class="hero-actions" style="opacity:0; animation:fadeIn 1s forwards 0.5s;">
                        <a href="#" target="_blank" id="play-btn" class="btn btn-primary">Launch</a>
                    </div>
                </div>
                <div class="games-container">
                    <div class="scroll-arrow left" onclick="Games.scroll(-1)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg></div>
                    <div class="scroll-arrow right" onclick="Games.scroll(1)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg></div>
                    <div class="carousel-track" id="card-track"></div>
                </div>
            </div>

            <!-- SETTINGS -->
            <div id="settings-view" class="content-view">
                <div class="settings-box">
                    <div class="st-header">
                        <h2>Control Center</h2>
                        <a href="https://ormsescaperoad.w3spaces.com/beta.html" class="beta-btn">Go to Beta <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px; margin-left:5px;"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg></a>
                    </div>
                    
                    <div class="st-body">
                        <div class="st-group">
                            <h3>Visuals</h3>
                            <div class="control-row">
                                <span>Light Mode</span>
                                <label class="switch"><input type="checkbox" id="theme-toggle" onchange="Settings.toggleTheme()"><span class="slider"></span></label>
                            </div>
                            <div class="control-row">
                                <span>Background URL</span>
                                <input type="text" class="st-input" id="bg-input" placeholder="https://..." onchange="Settings.setBg(this.value)">
                            </div>
                            <div class="control-row">
                                <span>Tab Cloak</span>
                                <button class="btn btn-ghost" onclick="Modals.open('spoof-modal')">Change</button>
                            </div>
                            <div class="control-row" style="flex-direction:column; align-items:flex-start; gap:10px; margin-top:15px;">
                                <span>3D Tilt Intensity: <span id="tilt-val" style="color:var(--accent)">500</span></span>
                                <input type="range" min="0" max="1000" value="500" class="range-slider" oninput="Settings.setTilt(this.value)">
                            </div>
                        </div>

                        <div class="st-group">
                            <h3>System</h3>
                            <div class="control-row">
                                <span>24-Hour Time</span>
                                <label class="switch"><input type="checkbox" id="time-toggle" onchange="Settings.toggleTime()"><span class="slider"></span></label>
                            </div>
                            <div class="control-row">
                                <span>Anti-Close</span>
                                <label class="switch"><input type="checkbox" id="ptc-toggle" onchange="Settings.togglePrevent()"><span class="slider"></span></label>
                            </div>
                        </div>

                        <div class="st-group">
                            <h3>Data & Reset</h3>
                            <div class="control-row">
                                <span>Factory Reset</span>
                                <button class="btn btn-danger" onclick="OOBE.reset()">Reset</button>
                            </div>
                             <div class="control-row">
                                <span>View Changelog</span>
                                <button class="btn btn-ghost" onclick="Changelog.open()">View</button>
                            </div>
                            <button class="btn btn-primary" style="width:100%; margin-top:15px;" onclick="Utils.openBlank()">Launch in about:blank</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CUSTOM DRAGGABLE MUSIC WINDOW -->
    <div id="music-window">
        <div class="win-header" id="mw-header">
            <div class="win-title">NexusX Player</div>
            <div class="win-close" onclick="MusicApp.toggle()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></div>
        </div>
        <div class="win-content">
            <iframe id="music-frame"></iframe>
        </div>
    </div>
    <script src="js/main.js"></script>
</body>
</html>
